{% extends "base.html" %}

{% block title %}SMS Settings - MissCall App{% endblock %}

{% block header_title %}SMS Settings{% endblock %}

{% block content %}
<div class="settings-container animate-fade-in">
    <div class="settings-section">
        <h2>SMS Настройки</h2>
        <div class="settings-content">
            <form method="POST" class="sms-settings-form">
                <!-- SMS Toggle Section -->
                <div class="setting-block">
                    <div class="setting-header" onclick="toggleSection('sms-section')">
                        <h3>Автоматични SMS-и</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="setting-content" id="sms-section">
                        <div class="setting-item">
                            <div class="toggle-wrapper">
                                <span class="toggle-label">Активиране на автоматични SMS-и</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" name="sms_enabled" 
                                           {% if current_user.sms_enabled %}checked{% endif %}>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="template-container">
                                <label>Шаблон на съобщението:</label>
                                <textarea name="sms_template" rows="3">{{ current_user.sms_template }}</textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Working Hours Section -->
                <div class="setting-block">
                    <div class="setting-header" onclick="toggleSection('hours-section')">
                        <h3>Работно време</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="setting-content" id="hours-section">
                        <div class="setting-item">
                            <div class="time-inputs">
                                <div class="time-field">
                                    <label>Начало на работния ден:</label>
                                    <input type="time" name="work_start" value="{{ current_user.work_start }}">
                                </div>
                                <div class="time-field">
                                    <label>Край на работния ден:</label>
                                    <input type="time" name="work_end" value="{{ current_user.work_end }}">
                                </div>
                            </div>
                            <div class="working-days">
                                <label>Работни дни:</label>
                                <div class="days-grid">
                                    {% for day in ['Пон', 'Вт', 'Ср', 'Чет', 'Пет', 'Съб', 'Нед'] %}
                                    <div class="day-checkbox">
                                        <input type="checkbox" name="work_days" value="{{ loop.index0 }}"
                                               {% if loop.index0 in current_user.work_days %}checked{% endif %}>
                                        <span>{{ day }}</span>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="template-container">
                                <label>Съобщение извън работно време:</label>
                                <textarea name="off_hours_message" rows="3">{{ current_user.off_hours_message }}</textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Vacation Mode Section -->
                <div class="setting-block">
                    <div class="setting-header" onclick="toggleSection('vacation-section')">
                        <h3>Режим "Отпуск"</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="setting-content" id="vacation-section">
                        <div class="setting-item">
                            <div class="toggle-wrapper">
                                <span class="toggle-label">Активиране на режим "Отпуск"</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" name="vacation_mode" 
                                           {% if current_user.vacation_mode %}checked{% endif %}>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="template-container">
                                <label>Съобщение за отпуск:</label>
                                <textarea name="vacation_message" rows="3">{{ current_user.vacation_message }}</textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="submit" class="save-btn">
                    <i class="fas fa-save"></i>
                    Запази настройките
                </button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
/* SMS Settings Specific Styles */
.settings-container {
    max-width: 800px;
    margin: 2rem auto;
    padding: 0 1rem;
}

.settings-section {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    padding: 2rem;
}

.setting-block {
    margin-bottom: 2rem;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
}

.setting-header {
    padding: 1rem;
    background: #f8fafc;
    border-radius: 8px 8px 0 0;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.setting-content {
    padding: 1.5rem;
}

.toggle-wrapper {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
}

/* Add your existing SMS settings styles here */
</style>
{% endblock %}

{% block scripts %}
<script>
function toggleSection(sectionId) {
    const section = document.getElementById(sectionId);
    const header = section.previousElementSibling;
    const icon = header.querySelector('i');
    
    section.classList.toggle('collapsed');
    icon.classList.toggle('fa-chevron-down');
    icon.classList.toggle('fa-chevron-up');
}

// Add your existing JavaScript here
</script>
{% endblock %}